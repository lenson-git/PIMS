<div id="inbound-view" class="view">
    <!-- ä¸Šéƒ¨ï¼šæ“ä½œåŒº -->
    <div class="card inbound-header-panel">
        <div class="inbound-controls">
            <!-- 1. SKU æ‰«ç è¾“å…¥ -->
            <div class="floating-label-group main-input">
                <input type="text" id="inbound-sku-input" placeholder=" " autocomplete="off" style="padding-right: 40px;">
                <label>æ‰«æ/è¾“å…¥ SKU</label>
                <button class="btn-icon-only scan-btn" title="å¼€å¯æ‘„åƒå¤´">
                    <svg viewBox="0 0 24 24" width="24" height="24"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>
                </button>
            </div>

            <!-- 2. ä»“åº“é€‰æ‹© -->
            <div class="floating-label-group">
                <select id="inbound-warehouse" name="warehouse" autocomplete="off">
                    <option value=""></option>
                    <option value="__new__">+ æ–°å»º...</option>
                </select>
                <label>å…¥åº“ä»“åº“</label>
            </div>

            <!-- 3. å…¥åº“ç±»å‹ -->
            <div class="floating-label-group">
                <select id="inbound-type" name="inbound_type" autocomplete="off">
                    <option value=""></option>
                    <option value="__new__">+ æ–°å»º...</option>
                </select>
                <label>å…¥åº“ç±»å‹</label>
            </div>

            <!-- 4. é‡‡è´­å•å¯¼å…¥ -->
            <div class="control-group" style="flex: 0 0 auto;">
                <button class="btn btn-outline btn-lg-height" onclick="triggerSheetUpload()">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                    å¯¼å…¥é‡‡è´­å•
                </button>
                <input type="file" id="sheet-upload-input" accept=".xlsx,.xls,.csv" hidden>
            </div>
        </div>
    </div>

    <!-- ä¸‹éƒ¨ï¼šå¾…å…¥åº“æ¸…å• -->
    <div class="card inbound-list-panel">
        <div class="panel-header">
            <div class="panel-title">å¾…å…¥åº“æ¸…å•</div>
            <div class="panel-actions">
                <button class="btn btn-black" onclick="submitInbound()">ç¡®è®¤å…¥åº“</button>
            </div>
        </div>
        <div class="table-container">
            <table class="data-table inbound-table">
                <thead>
                    <tr>
                        <th style="width: 60px">åºå·</th>
                        <th style="width: 100px">å›¾ç‰‡</th>
                        <th>SKU ä¿¡æ¯</th>
                        <th style="width: 120px">é‡‡è´­æ•°é‡</th>
                        <th style="width: 120px">å…¥åº“æ•°é‡</th>
                        <th style="width: 80px" class="text-center">æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody id="inbound-list-body">
                    <!-- ç¤ºä¾‹è¡Œ -->
                    <tr class="sku-row inbound-row" id="row-sku-123" onclick="showSKUDetails('SKU-123456')">
                        <td>1</td>
                        <td>
                            <div class="img-thumbnail-small" onclick="event.stopPropagation(); showLightbox('https://via.placeholder.com/1500');">
                                <img src="https://via.placeholder.com/100" alt="Product">
                            </div>
                        </td>
                        <td>
                            <div class="sku-info">
                                <div class="sku-code">SKU-123456</div>
                                <div class="sku-name text-secondary">ç¤ºä¾‹äº§å“åç§° - é»‘è‰² XL</div>
                            </div>
                        </td>
                        <td>
                            <input type="number" class="form-control-plaintext" value="10" readonly>
                        </td>
                        <td>
                            <div class="qty-input-group">
                                <button class="btn-qty-minus">-</button>
                                <input type="number" class="form-control-qty" value="1" autocomplete="off">
                                <button class="btn-qty-plus">+</button>
                            </div>
                        </td>
                        <td class="text-center">
                            <button class="btn-icon-action text-error" title="åˆ é™¤">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
            <!-- ç©ºçŠ¶æ€æç¤º -->
            <div id="inbound-empty-state" class="empty-state" style="display: none;">
                <div class="empty-icon">ğŸ“¦</div>
                <div class="empty-text">æš‚æ— å…¥åº“å•†å“ï¼Œè¯·æ‰«ææ¡ç æˆ–å¯¼å…¥é‡‡è´­å•</div>
            </div>
        </div>
    </div>
</div>

<!-- å¿«é€Ÿæ–°å»ºæ¨¡æ€æ¡† -->
<div id="quick-create-modal" class="modal-overlay">
    <div class="modal">
        <div class="modal-header">
            <h3>æ–°å»º SKU (æœªæ‰¾åˆ°æ¡ç )</h3>
            <button class="btn-close" onclick="closeModal('quick-create-modal')">
                <svg viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
        </div>
        <div class="modal-body">
            <div class="alert alert-warning">
                ç³»ç»Ÿæœªæ‰¾åˆ°æ¡ç  <strong id="unknown-barcode"></strong>ï¼Œè¯·å…ˆåˆ›å»ºè¯¥ SKUã€‚
            </div>
            <form id="quick-create-form">
                <div class="floating-label-group">
                    <input type="text" id="quick-barcode" readonly placeholder=" ">
                    <label>æ¡ç </label>
                </div>
                <div class="floating-label-group">
                    <input type="text" placeholder=" " autocomplete="off">
                    <label>äº§å“åç§°</label>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="closeModal('quick-create-modal')">å–æ¶ˆ</button>
            <button class="btn btn-black">åˆ›å»ºå¹¶å…¥åº“</button>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        loadSelectOptions('warehouse', 'warehouse');
        loadSelectOptions('inbound_type', 'inbound_type');
    });

    function submitInbound() {
        alert('ç¡®è®¤å…¥åº“ï¼');
    }

    function triggerSheetUpload() {
        document.getElementById('sheet-upload-input').click();
    }
</script>

<style>
    .inbound-header-panel {
        padding: 24px;
        margin-bottom: 24px;
    }

    .inbound-controls {
        display: flex;
        gap: 16px; /* é—´è·ç¨ä½œè°ƒæ•´ */
        align-items: flex-end;
        width: 100%; /* ç¡®ä¿å®¹å™¨å æ»¡æ•´è¡Œ */
    }

    .control-group {
        display: flex;
        flex-direction: column;
        gap: 4px; /* å‡å°æ ‡ç­¾ä¸è¾“å…¥æ¡†é—´è· */
        flex: 1;
        min-width: 120px;
    }

    .control-group.main-input {
        flex: 3;
        min-width: 300px;
    }

    /* é‡æ–°æ·»åŠ ä¸¢å¤±çš„æ ‡ç­¾æ ·å¼ */
    .control-group label {
        display: block;
        font-size: 12px; /* æç®€å°å­—ä½“ */
        font-weight: 500;
        color: #4b5563;
        margin-bottom: 0;
    }

    /* ç»Ÿä¸€è¾“å…¥æ¡†æ ·å¼ - ç´§å‡‘ç‰ˆ */
    .input-wrapper-large {
        position: relative;
    }

    .input-wrapper-large input {
        width: 100%;
        padding: 0 12px 0 16px;
        padding-right: 40px;
        font-size: 13px; /* å°å­—ä½“ */
        border: 1px solid #d1d5db;
        border-radius: 4px; /* è¾ƒå°åœ†è§’ */
        height: 36px; /* ç´§å‡‘é«˜åº¦ */
        outline: none;
        line-height: 36px;
    }
    
    .form-control {
        height: 36px; /* ç´§å‡‘é«˜åº¦ */
        font-size: 13px; /* å°å­—ä½“ */
        border-radius: 4px;
        padding: 0 12px;
    }
    
    .btn {
        height: 36px; /* æŒ‰é’®é«˜åº¦è·Ÿéš */
        font-size: 13px;
        padding: 0 16px;
        border-radius: 4px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }
    
    .input-wrapper-large input:focus {
        border-color: #1a1a1a;
    }

    .scan-btn {
        position: absolute;
        right: 10px;
        top: 50%;
        transform: translateY(-50%);
        color: #6b7280;
        background: none;
        border: none;
        cursor: pointer;
    }

    /* é‡‡è´­æ•°é‡æ— è¾¹æ¡†æ ·å¼ */
    .form-control-plaintext {
        display: block;
        width: 100%;
        padding: 6px 0;
        margin-bottom: 0;
        font-size: 15px;
        line-height: 1.5;
        color: #1a1a1a;
        background-color: transparent;
        border: solid transparent;
        border-width: 1px 0;
        font-weight: 500;
        text-align: center; /* å±…ä¸­æ˜¾ç¤º */
    }

    .inbound-list-panel {
        flex: 1;
        display: flex;
        flex-direction: column;
    }

    .panel-header {
        padding: 16px 24px;
        border-bottom: 1px solid #f3f4f6;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .panel-title {
        font-size: 16px;
        font-weight: 600;
    }

    .img-thumbnail-small {
        width: 60px;
        height: 60px;
        background: #f9fafb;
        border-radius: 4px;
        overflow: hidden;
        border: 1px solid #e5e7eb;
        cursor: zoom-in; /* é¼ æ ‡æŒ‡é’ˆ */
    }

    .img-thumbnail-small img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .sku-code {
        font-weight: 600;
        color: #1a1a1a;
    }

    .qty-input-group {
        display: flex;
        align-items: center;
        border: 1px solid #d1d5db;
        border-radius: 4px;
        width: 100px;
    }

    .btn-qty-minus, .btn-qty-plus {
        width: 30px;
        height: 30px;
        background: #f9fafb;
        border: none;
        cursor: pointer;
        font-weight: bold;
        color: #6b7280;
    }

    .btn-qty-minus:hover, .btn-qty-plus:hover {
        background: #e5e7eb;
        color: #1a1a1a;
    }

    .form-control-qty {
        width: 40px;
        text-align: center;
        border: none;
        border-left: 1px solid #d1d5db;
        border-right: 1px solid #d1d5db;
        height: 30px;
        font-weight: 600;
        outline: none;
    }


</style>
